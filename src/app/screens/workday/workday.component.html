<div class="container workspace">
  <div class="section image-section">
    <img src="../../../../assets/images/view-products.jpg" alt="Workspace" class="image">
  </div>

  <div class="section title-section">
    <p class="title">MY WORKSPACE</p>

    <div class="action-slot">
      <button
        *ngIf="showCheckOutButton"
        class="p-button-rounded checkout-title-button"
        (click)="onCheckOut()"
        [disabled]="loading">
        <span class="pi pi-sign-out"></span>
        <span class="button-text">Check out</span>
      </button>

      <button
        *ngIf="showCheckInButton"
        class="p-button-rounded checkin-title-button"
        (click)="onCheckIn()"
        [disabled]="loading">
        <span class="pi pi-sign-in"></span>
        <span class="button-text">Check in</span>
      </button>
    </div>
  </div>

  <app-check-in-popup
    *ngIf="showCheckInPopup"
    [userName]="userName"
    (closed)="onPopupClosed()">
  </app-check-in-popup>

  <app-check-out-popup
    *ngIf="showCheckOutPopup"
    [userName]="userName"
    (closed)="onCheckoutClosed()">
  </app-check-out-popup>

  <div class="section table-section">
    <div class="card">

      <section class="ws-status">
        <div class="status-header">
          <h3>Today’s status</h3>
          <span class="pill" [ngClass]="attendanceOpen ? 'ok' : 'off'">
            {{ attendanceOpen ? 'ON SHIFT' : 'OFF SHIFT' }}
          </span>
        </div>

        <div class="status-row">
          <div class="status-item">
            <span class="label">Assigned shift</span>
            <span class="value mono">{{ shiftLabel }}</span>
          </div>

          <div class="status-item">
            <span class="label">Check-in</span>
            <span class="value">{{ checkInTime || '—' }}</span>
          </div>

          <div class="status-item">
            <span class="label">Check-out</span>
            <span class="value">{{ checkOutTime || '—' }}</span>
          </div>

          <div class="status-item">
            <span class="label">Tips today</span>
            <span class="value accent">{{ tipsToday | currency:'USD' }}</span>
          </div>
        </div>
      </section>

      <section class="ws-board">
        <div class="board-head">
          <h3>Assigned tasks</h3>
          <small class="muted">Drag tasks between columns</small>
        </div>

        <div class="columns">
          <div class="col">
            <div class="col-title">Assigned</div>
            <div class="dropzone"
                 [class.is-dragover]="over.todo"
                 (dragenter)="onDragEnter('todo')"
                 (dragleave)="onDragLeave('todo')"
                 (dragover)="onDragOver($event)"
                 (drop)="onDrop($event, 'todo')">
              <div class="task"
                   *ngFor="let t of tasksTodo"
                   draggable="true"
                   (dragstart)="onDragStart($event, t, 'todo')">
                <div class="task-body">
                  <div class="task-title">{{ t.title }}</div>
                  <div class="task-note" *ngIf="t.note">{{ t.note }}</div>
                </div>
                <span class="task-tag" *ngIf="t.tag">{{ t.tag }}</span>
              </div>
              <div class="empty-col" *ngIf="!tasksTodo.length">No tasks</div>
            </div>
          </div>

          <div class="col">
            <div class="col-title">In progress</div>
            <div class="dropzone"
                 [class.is-dragover]="over.doing"
                 (dragenter)="onDragEnter('doing')"
                 (dragleave)="onDragLeave('doing')"
                 (dragover)="onDragOver($event)"
                 (drop)="onDrop($event, 'doing')">
              <div class="task"
                   *ngFor="let t of tasksDoing"
                   draggable="true"
                   (dragstart)="onDragStart($event, t, 'doing')">
                <div class="task-body">
                  <div class="task-title">{{ t.title }}</div>
                  <div class="task-note" *ngIf="t.note">{{ t.note }}</div>
                </div>
                <span class="task-tag" *ngIf="t.tag">{{ t.tag }}</span>
              </div>
              <div class="empty-col" *ngIf="!tasksDoing.length">Move tasks here</div>
            </div>
          </div>

          <div class="col">
            <div class="col-title">Finished</div>
            <div class="dropzone"
                 [class.is-dragover]="over.done"
                 (dragenter)="onDragEnter('done')"
                 (dragleave)="onDragLeave('done')"
                 (dragover)="onDragOver($event)"
                 (drop)="onDrop($event, 'done')">
              <div class="task done"
                   *ngFor="let t of tasksDone"
                   draggable="true"
                   (dragstart)="onDragStart($event, t, 'done')">
                <div class="task-body">
                  <div class="task-title">{{ t.title }}</div>
                  <div class="task-note" *ngIf="t.note">{{ t.note }}</div>
                </div>
                <span class="task-tag" *ngIf="t.tag">Done</span>
              </div>
              <div class="empty-col" *ngIf="!tasksDone.length">No finished tasks</div>
            </div>
          </div>
        </div>
      </section>

    </div>
  </div>
</div>
