<div class="container">
  <div class="column column-left">
    <p class="title">PRODUCT REGISTER</p>
    <form class="form">
      <div class="form-group">
        <label for="product-name">Product Name</label>
        <input
          pInputText
          id="product-name"
          [(ngModel)]="name"
          placeholder="Coffe with milk..."
          name="product_name" />
      </div>
      <div class="form-group">
        <label for="description">Description</label>
        <input
          pInputText
          id="description"
          [(ngModel)]="description"
          placeholder="Half coffe half milk..."
          name="description" />
      </div>
      <div class="form-group">
        <label for="price">Price</label>
        <input
          pInputText
          id="price"
          type="number"
          [(ngModel)]="price"
          placeholder="Enter price"
          name="product_price"
          min="0"
          (input)="onPriceChange($event)"
          (keypress)="onlyAllowNumbers($event)"
          required/>
      </div>
      <div class="form-group">
        <label for="category">Category</label>
        <div class="category-dropdown-container">
            <!-- Dropdown de categorías -->
            <p-dropdown 
              id="category" 
              [options]="categories" 
              [(ngModel)]="selectedCategory"
              placeholder="Select a category">
            </p-dropdown>
    
            <!-- Icono de edición para abrir el panel -->
            <button pButton icon="pi pi-pencil" class="p-button-rounded p-button-text"
                    (click)="goToCategories()"></button>
        </div>
      </div>
    

      <div class="card flex justify-content-center">
        <button (click)="showConfirmDialog()" [disabled]="!isFormValid() || loading"  class="btn-save">
          Save
        </button>
      </div>
    </form>
  </div>
  <div class="column column-right">
    <img src="../../../../assets/images/new_product.jpg" alt="Imagen de fondo" class="background-image">
    <app-categories
      *ngIf="showCategoryPanel" 
      (onSave)="handleCategorySave()" 
      (onClose)="handleCategoryClose()"
      class="app-categories-overlay">
    </app-categories>
  </div>

  <!-- Spinner overlay -->
  <div *ngIf="loading" class="loading-overlay">
    <p-progressSpinner></p-progressSpinner>
  </div>
</div>

<p-dialog [(visible)]="displayConfirmDialog" [modal]="true" header="Register new product" [closable]="true">
  <app-confirmation-pop-up
    [subtitle]="'Are you sure you want to proceed?'"
    (onClose)="closeConfirmDialog()"
    (onSend)="onRegister()">
  </app-confirmation-pop-up>
</p-dialog>

<p-dialog [(visible)]="displayErrorDialog" [modal]="true" header="Error" [closable]="true">
  <app-notice
    [subtitle]="errorSubtitle"
    (onClose)="closeErrorDialog()">
  </app-notice>
</p-dialog>

<p-toast></p-toast>
